function pagarmeToken(){var a={};a.card_holder_name=$("#titular-cartao").val(),a.card_expiration_date=$("#validade-cartao").val(),a.card_number=$("#numero-cartao").val().trim(),a.card_cvv=$("#cvv-cartao").val();var e=pagarme.validate({card:a});pagarme.client.connect({encryption_key:""+pagarme_encryption_key}).then(e=>e.security.encrypt(a)).then(a=>{if($("#card-hash").val(a),!e.card.card_number)return alert("Cartão inválido!"),!1;grecaptcha.ready(function(){grecaptcha.execute(""+recaptcha_key,{action:"assinar"}).then(function(a){jQuery("#form-assinar").prepend('<input type="hidden" name="token" value="'+a+'">'),jQuery("#form-assinar").prepend('<input type="hidden" name="action" value="assinar">'),jQuery("#form-assinar").unbind("submit").submit(),jQuery("#concluir").html("Aguarde..."),jQuery("#concluir").attr("disabled","disabled")})})})}$(document).ready(function(){$("#parcelas").change(function(){$("#parcela-selecionada").text($("#parcelas option:selected").val())}),$("#box_anual").click(function(){$("#plano").val(id_plan_yearly),$("#plano_periodo").val("yearly")}),$("#box_mensal").click(function(){$("#plano").val(id_plan_monthly),$("#plano_periodo").val("monthly")});var a,e={};function n(){$(".filter").fadeOut(1e3,function(){$(".filter").fadeTo(0,.5),$(".filter").addClass("hidden"),redirect("/login")})}$("#telefone").inputmask("(99) 99999-9999"),$("#cpf").inputmask("999.999.999-99",{clearIncomplete:!0}),$("#numero-cartao").inputmask("9999 9999 9999 9999",{clearIncomplete:!0}),$("#validade-cartao").inputmask("99/99",{clearIncomplete:!0}),$("#cvv-cartao").inputmask("9{3,4}"),$("#cep").inputmask("99999-999",{clearIncomplete:!0}),$("#numero-rua").inputmask("9{1,6}"),$("#cep").keyup(async function(){if(8==$("#cep").val().replaceAll(/[_.-]/g,"").length){var a=$("#cep").val().replaceAll(/[.-]/g,"");await fetch("https://viacep.com.br/ws/"+a+"/json",{method:"GET",mode:"cors",cache:"default"}).then(a=>{a.json().then(a=>{$("#rua").val(a.logradouro),e.rua=a.logradouro,$("#bairro").val(a.bairro),e.bairro=a.bairro,$("#uf").val(a.uf),e.uf=a.uf,$("#cidade").val(a.localidade),e.cidade=a.cidade})}).catch(a=>{console.log("Um erro ocorreu: ",a.message)})}}),$(".plano-anual").click(function(){$("#parcelas").removeClass("hidden"),$(".plano-anual").addClass("selecionado"),$(".plano-mensal").removeClass("selecionado"),$(".resumo-mensal").addClass("hidden"),$(".resumo-anual").removeClass("hidden")}),$(".plano-mensal").click(function(){$("#parcelas").addClass("hidden"),$(".plano-mensal").addClass("selecionado"),$(".plano-anual").removeClass("selecionado"),$(".resumo-mensal").removeClass("hidden"),$(".resumo-anual").addClass("hidden")}),$("#nome").keyup(function(a){/ /.test(a.key)||/[a-z]/.test(a.key)||/[A-Z]/.test(a.key)||$("#nome").val($("#nome").val().substring(0,$("#nome").val().length-1))}),$("#titular-cartao").keyup(function(a){/ /.test(a.key)||/[a-z]/.test(a.key)||/[A-Z]/.test(a.key)||$("#titular-cartao").val($("#titular-cartao").val().substring(0,$("#titular-cartao").val().length-1))}),$("#concluir").click(function(){var a=null==$(".plano-anual.selecionado").val();e={nome:$("#nome").val(),lastName:$("#last_name").val(),dataNascimento:$("#data-nascimento").val(),sexo:$("#sexo option:selected").val(),cpf:$("#cpf").val(),souEstrangeiro:$("#estrangeiro:checked").val(),senha:$("#senha").val(),senhaRepetida:$("#senha-repetida").val(),apelido:$("#apelido").val(),email:$("#email").val(),telefone:$("#telefone").val(),cep:$("#cep").val(),rua:$("#rua").val(),numeroRua:$("#numero-rua").val(),complemento:$("#complemento").val(),bairro:$("#bairro").val(),cidade:$("#cidade").val(),uf:$("#uf").val(),planoMensal:a,numeroCartao:$("#numero-cartao").val(),titularCartao:$("#titular-cartao").val(),cvv:$("#cvv-cartao").val(),validadeCartao:$("#validade-cartao").val(),parcelas:$("#parcelas option:selected").val()};var n=validarCheckout(e);if(null!=n&&n.includes("nome"))return $("#nome-invalido").removeClass("hidden"),!1;if($("#nome-invalido").addClass("hidden"),null!=n&&n.includes("last_name"))return $("#last_name-invalido").removeClass("hidden"),!1;if($("#last_name-invalido").addClass("hidden"),null!=n&&""==$("#data-nascimento").val())return $("#data-nascimento-invalido").removeClass("hidden"),!1;if($("#data-nascimento-invalido").addClass("hidden"),null!=n&&n.includes("email"))return $("#email-invalido").removeClass("hidden"),!1;if($("#email-invalido").addClass("hidden"),null!=n&&n.includes("cpf"))return $("#cpf-invalido").removeClass("hidden"),!1;if($("#cpf-invalido").addClass("hidden"),null!=n&&n.includes("senha-curta"))return $("#senha-curta").removeClass("hidden"),!1;if($("#senha-curta").addClass("hidden"),null!=n&&n.includes("senha-divergente"))return $("#senha-divergente").removeClass("hidden"),!1;if($("#senha-divergente").addClass("hidden"),/[^a-zA-Z ]/.test($("#apelido").val().replaceAll(" ","")))return $("#apelido-invalido").removeClass("hidden"),!1;if($("#apelido-invalido").addClass("hidden"),null!=n&&n.includes("cartao"))return $("#cartao-invalido").removeClass("hidden"),!1;$("#cartao-invalido").addClass("hidden");var l="Campo(s) obrigatório(s): ";return null!=n&&n.includes("telefone")?(l+="telefone, ",$("#endereco-invalido").removeClass("hidden"),!1):null!=n&&n.includes("cep")?(l+="CEP, ",$("#endereco-invalido").removeClass("hidden"),!1):null!=n&&n.includes("rua")?(l+="rua, ",$("#endereco-invalido").removeClass("hidden"),!1):(null!=n&&n.includes("numero-rua")&&(l+="número, "),null!=n&&n.includes("bairro")?(l+="bairro, ",$("#endereco-invalido").removeClass("hidden"),!1):null!=n&&n.includes("cidade")?(l+="cidade, ",$("#endereco-invalido").removeClass("hidden"),!1):", "==l.slice(l.length-2)?(l=l.slice(0,length-2)+".",$("#endereco-invalido").removeClass("hidden"),!1):($("#erro-endereco").text(l),"Campo(s) obrigatório(s): "==l?$("#endereco-invalido").addClass("hidden"):n.push("endereco"),0==n.length&&($(".filter").removeClass("hidden"),validarCartao(e.numeroCartao,e.titularCartao,e.validadeCartao,e.cvv).then(a=>{})),void pagarmeToken()))}),$(".filter").click(function(){$("#pop-up-success").hasClass("hidden")?(clearTimeout(a),$("#pop-up-error").fadeOut(500,function(){$("#pop-up-error").fadeTo(0,1),$("#pop-up-error").addClass("hidden")}),n()):$("#pop-up-error").hasClass("hidden")&&(clearTimeout(a),$("#pop-up-success").fadeOut(500,function(){$("#pop-up-success").fadeTo(0,1),$("#pop-up-success").addClass("hidden")}),n())})});